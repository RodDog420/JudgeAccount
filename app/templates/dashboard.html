{% extends "base.html" %}
{% set private_page = True %}

{% block title %}My Dashboard - JudgeAccount{% endblock %}

{% block robots %}
<meta name="robots" content="noindex, nofollow">
{% endblock %}

{% block content %}
<h1>My Dashboard</h1>

<p>Welcome back, {{ current_user.username }}! Here are all your submissions.</p>

<!-- Media Links Section -->
<h2>My Media Links</h2>
{% if media_links %}
    <p class="content-count">You have submitted {{ media_links|length }} media link(s)</p>
    
    {% for media_link in media_links %}
    <div class="media-link-card">
        <div class="media-link-header">
            <div>
                <h3 class="judge-name-heading">
                    <span class="judge-name-text">
                        <a href="{{ url_for('main.judge', judge_id=media_link.judge_id) }}" class="user-content-name">{{ media_link.judge.full_name() }}</a>
                    </span>    {% if media_link.judge.is_federal %}
                        <span class="badge badge-federal">Federal</span>
                    {% endif %}
                </h3>
                <p class="judge-court-info user-content-name">
                    {{ media_link.judge.court }} - {{ media_link.judge.city }}, {{ media_link.judge.state }}
                </p>
            </div>
            <span class="media-link-source user-content-text">{{ media_link.news_source }}</span>
        </div>
        
        <h4 class="media-link-headline">
            <a href="{{ media_link.url }}" target="_blank" rel="noopener noreferrer" class="user-content-url">
                {{ media_link.headline }}
            </a>
        </h4>
        
        <div class="media-link-date">
            <span class="date-item">Published: {{ media_link.publication_date.strftime('%B %d, %Y') }}</span>
            <span class="date-item">Submitted: {{ media_link.created_at.strftime('%B %d, %Y') }}</span>
        </div>
        
        <div class="media-link-summary user-content-text">
            {{ media_link.summary }}
        </div>
        
        {% if not media_link.is_verified %}
        <div class="pending-verification">
            <strong>⚠️ Pending Verification</strong> - This link will appear on the judge's page once approved by our moderation team.
        </div>
        {% endif %}
        
        <div class="user-actions">
            <a href="{{ media_link.url }}" target="_blank" rel="noopener noreferrer" class="btn media-link-button">
                View Article
            </a>
            <a href="{{ url_for('auth.edit_media_link', media_link_id=media_link.id) }}" class="btn btn-primary">Edit</a>
            <a href="{{ url_for('auth.delete_media_link', media_link_id=media_link.id) }}" class="btn btn-secondary" 
                onclick="return confirm('Are you sure you want to delete this media link?');">Delete</a>
        </div>
    </div>
    {% endfor %}
{% else %}
    <div class="no-media-links">
        <p>You haven't submitted any media links yet.</p>
        <a href="{{ url_for('main.submit_media_link') }}" class="btn btn-primary">Submit Your First Media Link</a>
    </div>
{% endif %}

<!-- Reviews Section -->
<h2 class="section-divider">My Reviews</h2>
{% if reviews %}
    <p class="content-count">You have submitted {{ reviews|length }} review(s)</p>
    
    {% for review in reviews %}
    <div class="review-card">
        <div class="review-header">
            <div>
                <h3 class="judge-name-heading">
                    <span class="judge-name-text">
                        <a href="{{ url_for('main.judge', judge_id=review.judge_id) }}" class="user-content-name">{{ review.judge.full_name() }}</a>
                    </span>
                        {% if review.judge.is_federal %}
                        <span class="badge badge-federal">Federal</span>
                    {% endif %}
                </h3>
                <p class="judge-court-info user-content-name">
                    {{ review.judge.court }} - {{ review.judge.city }}, {{ review.judge.state }}
                </p>
            </div>
            <span class="review-rating">{{ review.rating }} / 5 stars</span>
        </div>
        
        <div class="review-metadata">
            <span class="date-item">Court Date: {{ review.court_date.strftime('%B %d, %Y') }}</span> 
            <span class="date-item">Submitted: {{ review.created_at.strftime('%B %d, %Y') }}</span>
        </div>
        
        {% if review.fairness_concern or review.bias_concern or review.temperament_concern %}
        <div class="review-concerns">
            {% if review.fairness_concern %}
                <span class="badge badge-fairness">Fairness Concern</span>
            {% endif %}
            {% if review.bias_concern %}
                <span class="badge badge-bias">Bias Concern</span>
            {% endif %}
            {% if review.temperament_concern %}
                <span class="badge badge-temperament">Temperament Concern</span>
            {% endif %}
        </div>
        {% endif %}
        
        <div class="review-text user-content-text">
            {{ review.review_text }}
        </div>
        
        <div class="user-actions">
            <a href="{{ url_for('auth.edit_review', review_id=review.id) }}" class="btn btn-primary">Edit</a>
            <a href="{{ url_for('auth.delete_review', review_id=review.id) }}" class="btn btn-secondary" 
                onclick="return confirm('Are you sure you want to delete this review?');">Delete</a>
        </div>
    </div>
    {% endfor %}
    
{% else %}
    <div class="no-reviews">
        <p>You haven't submitted any reviews yet.</p>
        <a href="{{ url_for('main.submit_review') }}" class="btn btn-primary">Submit Your First Review</a>
    </div>
{% endif %}
{% endblock %}