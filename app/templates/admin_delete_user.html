{% extends "base.html" %}
{% set private_page = True %}

{% block title %}Delete User: {{ user.username }} - Admin{% endblock %}

{% block robots %}
<meta name="robots" content="noindex, nofollow">
{% endblock %}

{% block content %}


<h1>Delete User: <span class="user-content-username">{{ user.username }}</span></h1>
<p class="admin-mode-notice">⚠️ DANGER: This action is PERMANENT and IRREVERSIBLE</p>

<div class="admin-search-form admin-search-form-centered">
    <h3 class="form-section-title">User Information</h3>
    
    <div class="spacing-bottom-sm">
        <p><strong>Username:</strong> <span class="user-content-username">{{ user.username }}</span></p>
        <p><strong>Email:</strong> <span class="user-content-email">{{ user.email }}</span></p>
        <p><strong>Reviews:</strong> {{ user.get_review_count() }}</p>
        <p><strong>Media Links:</strong> {{ user.get_media_link_count() }}</p>
        <p><strong>Joined:</strong> {{ user.created_at.strftime('%B %d, %Y') }}</p>
    </div>
    
    <div class="alert-warning">
        <h4 class="alert-heading">⚠️ Critical Warning - Permanent Deletion</h4>
        <p class="alert-text"><strong>This action CANNOT be undone. When you delete this user:</strong></p>
        <ul class="alert-list">
            <li>The user account will be <strong>permanently deleted</strong> from the database</li>
            <li>All reviews and media links will remain but show as "deleted user"</li>
            <li>The user will be able to create a new account with the same email/username</li>
            <li>All admin notes and historical records associated with this user will be lost</li>
            <li>This action will be logged in the admin activity log</li>
        </ul>
        <p class="alert-text spacing-top-sm"><strong>Alternative:</strong> Consider banning the user instead. Bans are reversible and preserve user history.</p>
    </div>
    
    <form method="POST" action="{{ url_for('auth.delete_user', user_id=user.id) }}">
        <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
        
        <div class="form-group">
            <label for="delete_reason">Reason for Deletion *</label>
            <textarea id="delete_reason" name="delete_reason" class="form-control" rows="5" required
                        placeholder="Explain why this user account is being permanently deleted..."></textarea>
            <span class="form-help-text">
                This reason will be logged for administrative records.
            </span>
        </div>
        
        <div class="form-group">
            <label for="confirm_username">Type the username to confirm: <strong class="user-content-username">{{ user.username }}</strong></label>
            <input type="text" id="confirm_username" name="confirm_username" class="form-control" required
                    placeholder="Type username exactly to confirm deletion">
            <span class="form-help-text">
                You must type the username exactly as shown above to proceed with deletion.
            </span>
        </div>
        
        <div class="form-actions">
            <button type="submit" class="btn btn-danger"
                    onclick="return confirm('FINAL WARNING: Are you ABSOLUTELY CERTAIN you want to permanently delete {{ user.username }}? This CANNOT be undone!');">
                ⚠️ PERMANENTLY DELETE USER
            </button>
            <a href="{{ url_for('auth.view_user_activity', user_id=user.id) }}" class="btn btn-gray">
                Cancel
            </a>
        </div>
    </form>
</div>

{% endblock %}